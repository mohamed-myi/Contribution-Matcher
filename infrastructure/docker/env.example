# =============================================================================
# Contribution Matcher - Docker Environment Configuration
# =============================================================================
# Copy this file to .env in the project root and fill in your values:
#   cp docker/env.example .env
# =============================================================================

# -----------------------------------------------------------------------------
# Required Settings
# -----------------------------------------------------------------------------

# JWT Secret - MUST be at least 32 characters
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(48))"
JWT_SECRET_KEY=your-very-long-and-secure-jwt-secret-key-here-at-least-32-chars

# GitHub OAuth (for user authentication)
GITHUB_CLIENT_ID=your_github_oauth_client_id
GITHUB_CLIENT_SECRET=your_github_oauth_client_secret

# GitHub Personal Access Token (for API discovery)
# Generate at: https://github.com/settings/tokens
PAT_TOKEN=ghp_your_personal_access_token

# -----------------------------------------------------------------------------
# Security Settings (STRONGLY RECOMMENDED FOR PRODUCTION)
# -----------------------------------------------------------------------------

# Token encryption key - Fernet key for encrypting GitHub access tokens at rest
# IMPORTANT: Without this key, GitHub tokens are stored in plaintext in the database
# If your database is compromised, attackers could access all users' GitHub accounts
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
TOKEN_ENCRYPTION_KEY=

# Require encryption (fail startup if encryption key not set)
# Recommended: true for production
REQUIRE_ENCRYPTION=false

# Strict security mode (fail on warnings too)
# Recommended: true for production
STRICT_SECURITY=false

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------

POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=contribution_matcher
POSTGRES_PORT=5432

# Full database URL (constructed from above in docker-compose)
# DATABASE_URL=postgresql://postgres:postgres@postgres:5432/contribution_matcher

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------

REDIS_PORT=6379
REDIS_PASSWORD=

# -----------------------------------------------------------------------------
# API Configuration
# -----------------------------------------------------------------------------

API_PORT=8000
DEBUG=false
JSON_LOGS=true

# Environment mode - CRITICAL for security
# Set to "production" or "prod" to enable strict security validation
# In production mode, the app will REFUSE TO START with weak/default secrets
ENV=development

# CORS - comma-separated list of allowed origins
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# -----------------------------------------------------------------------------
# Frontend Configuration (optional)
# -----------------------------------------------------------------------------

FRONTEND_PORT=5173
VITE_API_URL=http://localhost:8000

# -----------------------------------------------------------------------------
# Scheduler Configuration
# -----------------------------------------------------------------------------

ENABLE_SCHEDULER=true
SCHEDULER_DISCOVERY_LIMIT=50

# Discovery cron schedule (default: 6 AM UTC daily)
SCHEDULER_DISCOVERY_CRON=0 6 * * *

# Scoring cron schedule (default: 6:30 AM UTC daily)
SCHEDULER_SCORING_CRON=30 6 * * *

# ML training cron schedule (default: 7 AM UTC daily)
SCHEDULER_ML_CRON=0 7 * * *

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------

# Auth rate limit (requests per window)
AUTH_RATE_LIMIT=5
AUTH_RATE_WINDOW=300

# API rate limit (requests per window)
API_RATE_LIMIT=100
API_RATE_WINDOW=60
